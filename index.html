<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="keywords" content="Adventure Games, Arcade Games, Girls Games, Shooting Games, Racing Games">
        <meta name="format-detection" content="telephone=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <style>
        body,html{padding:0;border:0;margin:0;height:100%;width:100%}#div_iframe_game{height:100%;width:100%;position:absolute;left:0;top:0}#iframe_game{width:100%}#game_banner{width:100%;z-index:999;justify-content:center;display:flex;position:absolute}.loadingMc{margin:auto;width:100%;height:100%;z-index:99;position:absolute;background:#2596be}.gameIconPanret{width:140px;height:140px;border-radius:100%;overflow:hidden;position:absolute;top:50%;left:50%;margin-top:-70px;margin-left:-70px;z-index:99} .gameIcon{width:100%} .loadNumPanret{width:140px;height:140px;position:absolute;top:50%;left:50%;margin-top:100px;z-index:99}.loadMc{width:140px;height:140px;position:absolute;top:50%;left:50%;margin-top:-75px;margin-left:-75px;z-index:99;border-radius:50%;border:5px solid #FFFFF0;border-top:5px solid #08da4e;animation:load 2s linear infinite}@keyframes load{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
        </style>
        <title></title>
        <script type="text/javascript">
                var gGame = {    
                    data_ad_client:"ca-pub-1394526330842049",
                    data_ad_channel:"6206130407" ,       
                    name: "ChristmasJigsawPuzzles",
                    url:"./game.html",
                    icon:"./icon.jpg",
                    isShowLoadNum:1,
                    loadingInterval:250
                }; 
                window.isUploadCY = !1;
                document.title = (gGame.name).replace(new RegExp("_","gi")," ")
                var purl = window.location.href;
                if(purl.indexOf("192.168") > -1 || purl.indexOf("127.0") > -1)
                {
                    window["new_afg_isTest"] = true;
                }else
                {
                    window["new_afg_isTest"] = false;
                }


        </script>
    </head>
    <body>
        <div id="loadingMc" class="loadingMc">
            
        </div>
        <div id="div_iframe_game">
            <iframe
                id="iframe_game"
                webkitallowfullscreen="true"
                mozallowfullscreen="true"
                allowfullscreen="true"
                webkit-playsinline="true"
                scrolling="no"
                seamless
                frameborder="0"
                style="display:block;overflow:hidden;"
            ></iframe>
        </div>
        <div id="game_banner" style ="bottom: 0; height: 8%;">
            <ins class="adsbygoogle" style="display:inline-block;width:100%; margin-top: 5px"
            data-ad-client= "ca-pub-1394526330842049" data-ad-slot="2848231678"></ins>
            <script type="text/javascript">
                    (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        <script>
        window.isUploadCY = !1;
       
        window.game = {
            init: function() {
           
                const div_gameIframeEl = document.getElementById('iframe_game');
 
                div_gameIframeEl.style.height = "92%";

                div_gameIframeEl.src = gGame.url;
            }
        };
        window.game.init();
    
        window.loading = {  
            loadingProgerss:0,
            itervalId:0,
            init: function() {
    
                var a = document.getElementById("loadingMc");
                a.innerHTML = '<div id="loadMc" class="loadMc"></div> <div id="gameIconPanret" class="gameIconPanret"><img id="gameIcon"  src="" ></div> <div id="loadNumPanret" class="loadNumPanret"> <span id="span" style="color:  rgba(142, 204, 237, 1);font-weight: bolder;font-size: 18px;text-align: center;width: 140px;left: -70px;position:absolute;">0%</span>  </div>';
                var loadingImgEl = document.getElementById("gameIcon");
                loadingImgEl.setAttribute('src', gGame.icon);
                loadingImgEl.style.width = "100%";
                this.show();
            },
            show: function() {
                const loadingProgerssTxt = document.querySelector('#span');
                this.itervalId = setInterval(() => {
                    this.loadingProgerss += 1;
                    if(this.loadingProgerss >= 100){
                        clearInterval(this.itervalId);
                        this.hide();
                    }
                loadingProgerssTxt.innerHTML = ( Math.trunc(this.loadingProgerss)).toString() + '%'; 
                }, window["new_afg_isTest"]?60:gGame.loadingInterval);
            },
            hide: function () {
                const loadingContainerEl = document.querySelector('#loadingMc');
                loadingContainerEl.style.display = 'none';
                clearInterval(this.itervalId);
            },
        }
        window.loading.init();
    
        window.insertScript = (url, attributes, callback) => {
            const scriptElement = document.createElement('script'),
            head = document.head || document.getElementsByTagName('head')[0];
            scriptElement.async = true;
    
        
            callback = callback || function() {};
            if (scriptElement.readyState) {
                scriptElement.onreadystatechange = () => {
                    if (scriptElement.readyState === 'loaded' || scriptElement.readyState === 'complete') {
                        scriptElement.onreadystatechange = null;
                        callback();
                    }
                }
            } else {
                scriptElement.onload = () => {
                    callback();
                };
            }
    
            scriptElement.src = url;
            if (attributes) {
                for (let k in attributes) {
                    if(!window["new_afg_isTest"] ){

                       if(k ==  "data-adbreak-test"){
                            continue;
                       }
                    }
                    scriptElement.setAttribute(k, attributes[k]);
           
                }
            }
            head?.appendChild(scriptElement);
            console.log('load js: ', url);
            return scriptElement;
        }
    
       
        window.h5_sdk = {
            sdk_url: 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js',
            init: function (callback) {
                window.insertScript(this.sdk_url,
                {
                    "data-ad-client":gGame.data_ad_client,
                    "crossorigin":"anonymous",
                    "data-ad-frequency-hint":"30s",
                    "data-adbreak-test":"on"

                }, () => {
                    window.adsbygoogle = window.adsbygoogle || []; 
                    window.adBreak = window.adConfig = function(o) {adsbygoogle.push(o);} 
                    window.adConfig({preloadAdBreaks: 'on'});
                });
            },
            adIntervalTime: 45,
            adShowTime: (new Date()).getTime(),
            
            getClientHeight: function() {
                return document.body.clientHeight && document.documentElement.clientHeight ? document.body.clientHeight < document.documentElement.clientHeight ? document.body.clientHeight : document.documentElement.clientHeight : document.body.clientHeight > document.documentElement.clientHeight ? document.body.clientHeight : document.documentElement.clientHeight
            },
            /**
             *
             * @param {*} ad_type
             * @param {*} success
             * @param {*} failed
             */
            showAd: function (ad_type, success = null, failed = null) {
                switch (ad_type) {
                    case 'Interstitial':
                        this.showInterstitialAd(success);
                        break;
    
                    case 'Reward':
                        this.showRewardAd(success, failed);
                        break;
    
                    default:
                        break;
                }
            },
           
            /**
             *
             * @param {*} success
             */
            showInterstitialAd: function (success) {
                let  lastShowAdTime = ((new Date()).getTime() - this.adShowTime) / 1000;
                console.log(lastShowAdTime);
                if (lastShowAdTime > this.adIntervalTime) {
                    if(!window.adBreak){
                        window.adsbygoogle = window.adsbygoogle || []; 
                        window.adBreak = window.adConfig = function(o) {adsbygoogle.push(o);} 
                        window.adConfig({preloadAdBreaks: 'on'});
                    }   
                    window.adBreak && console.log('==== h5_sdk showInterstitialAd ====');
                    this.adShowTime = (new Date()).getTime();
                    window.adBreak && window.adBreak({
                        type: "next",
                        name: "next",
                        adBreakDone: () => {
                            success && success();
                        },
                    });
                } else {
                    success && success();
                }
            },
            /**
             *
             * @param {*} success
             * @param {*} failed
             */
            showRewardAd: function (success, failed) {  
                if(!window.adBreak){
                    window.adsbygoogle = window.adsbygoogle || []; 
                    window.adBreak = window.adConfig = function(o) {adsbygoogle.push(o);} 
                    window.adConfig({preloadAdBreaks: 'on'});
                }          
                window.adBreak && console.log('==== h5_sdk showRewardAd ====');
                    window.adBreak &&   window.adBreak({
                        type: "reward",
                        name: "reward",
                        beforeReward: (showAdFn) => {
                            showAdFn();
                        },
                        adViewed: () => {
                            success && success();
                        },
                        adDismissed: () => {
                            failed && failed();
                        },
                        adBreakDone: (placementInfo) => {
                            if (placementInfo.breakStatus !== "viewed") {
                                failed && failed();
                            }
                        },
                }); 
                
                !window.adBreak&&failed && failed();
            },
       
            showGameLoadingCompleted: function () {
             window.loading.hide();
             if (!window.isUploadCY)
                try {
                    console.log("----uploadCYLoadComplete----");
                    window.isUploadCY = !0;
                    window.adBreak({
                        type: "preroll",
                        name: "my_preroll",
                        adBreakDone: () => {},// 也不要在这里初始化游戏，因为用户不关闭广告，则游戏无法初始化！！！
                    });
                } catch (e) {}
               
            },
    
            getGameName: function() {
                let pathNameArr = window.location.pathname.split('/');
                let gameNameIndex = pathNameArr.length > 3 ? 3 : 1;
                return pathNameArr[gameNameIndex];
            }
        };

        window.h5_sdk.init();
        </script>
    </body>
</html>
